初步实现，很多地方有待完善
